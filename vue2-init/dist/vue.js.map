{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n    return typeof val == 'function'\r\n}\r\nexport function isObject(val) {\r\n    return typeof val == 'object' && val !== null;\r\n}\r\nexport let isArray = Array.isArray","let oldArrayPrototype = Array.prototype\r\nexport let arrayMethods = Object.create(oldArrayPrototype) // // 让arrayMethods 通过__proto__ 能获取到数组的方法\r\n\r\nlet methods = [ // 只有这七个方法 可以导致数组发生变化\r\n    'push',\r\n    'shift',\r\n    'unshift',\r\n    'pop',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function (...arg) {\r\n        // 数组新增的属性 要看一下是不是对象 如果是对象 继续进行劫持\r\n        // 需要调用数组原生逻辑\r\n        oldArrayPrototype[method].call(this, ...arg)\r\n        let inserted = null\r\n        let ob = this.__ob__\r\n        switch (method) {\r\n            case 'splice':\r\n                inserted = arg.slice(2)\r\n                break\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = arg\r\n                break\r\n        }\r\n        if (inserted) ob.observeArray(inserted)\r\n\r\n    }\r\n})","import { isArray, isObject } from '../utils.js'\r\nimport { arrayMethods } from \"./array.js\"\r\nclass Observe {\r\n    constructor(value) {\r\n        // 不让__ob__被遍历到\r\n        // value.__ob__ = this \r\n        Object.defineProperty(value, '__ob__', {\r\n            value: this,\r\n            enumerable: false // 标识这个属性不能被列举出来 不能被循环到\r\n        })\r\n        if (isArray(value)) {\r\n            value.__proto__ = arrayMethods\r\n            this.observeArray(value)\r\n        } else {\r\n            this.walk(value)\r\n        }\r\n    }\r\n    walk(target) {\r\n        Object.keys(target).forEach(key => {\r\n            defineReactive(target, key, target[key])\r\n        })\r\n    }\r\n    observeArray(data) { // 递归遍历数组，对数组内部的对象再次重写 [[]] [{}]\r\n        data.forEach(item => observe(item))\r\n    }\r\n\r\n}\r\nfunction defineReactive(target, key, value) {\r\n    Object.defineProperty(target, key, {\r\n        get() {\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            if (newValue == value) return\r\n            observe(newValue) // 设置的值如果是对象 继续进行劫持\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\nexport function observe(data) {\r\n    // data 就是我们用户传入的数据 我们需要对他进行观测\r\n    if (!isObject(data)) {\r\n        return\r\n    }\r\n    if (data.__ob__) {\r\n        return\r\n    }\r\n    // 后续我们要知道是否这个对象被观测过了\r\n    return new Observe(data) // xxx instanceof Observe\r\n}","import { observe } from \"./observer/index.js\"\r\n\r\nexport function initState(vm) {\r\n    const options = vm.$options\r\n    // 先props 再methods 再data 再 computed 再watch\r\n    if (options.props) {\r\n\r\n    }\r\n    if (options.methods) {\r\n\r\n    }\r\n    if (options.data) {\r\n        initData(vm)\r\n    }\r\n    if (options.computed) {\r\n        initComputed(vm)\r\n    }\r\n    if (options.watch) {\r\n        initWatch(vm)\r\n    }\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data\r\n    // 需要对用户提供的data属性把他的所有属性进行重写 增添get和set，只能拦截已经存在的属性\r\n    console.log(data)\r\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data\r\n    observe(data)\r\n\r\n}\r\nfunction initComputed() {\r\n\r\n}\r\nfunction initWatch() {\r\n\r\n}","import { initState } from './state.js';\r\nexport default function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        console.log(options)\r\n        const vm = this\r\n        vm.$options = options\r\n        initState(vm)\r\n    }\r\n}","import  initMixin from './init.js'\r\nfunction Vue(options) {\r\n    this._init(options)\r\n}\r\ninitMixin(Vue)\r\nexport default Vue"],"names":["isObject","val","isArray","Array","oldArrayPrototype","prototype","arrayMethods","Object","create","methods","forEach","method","arg","call","inserted","ob","__ob__","slice","observeArray","Observe","value","defineProperty","enumerable","__proto__","walk","target","keys","key","defineReactive","data","item","observe","get","set","newValue","initState","vm","options","$options","props","initData","computed","watch","console","log","_data","initMixin","Vue","_init"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAGO,SAASA,QAAT,CAAkBC,GAAlB,EAAuB;EAC1B,EAAA,OAAO,QAAOA,GAAP,CAAA,IAAc,QAAd,IAA0BA,GAAG,KAAK,IAAzC,CAAA;EACH,CAAA;EACM,IAAIC,OAAO,GAAGC,KAAK,CAACD,OAApB;;ECNP,IAAIE,iBAAiB,GAAGD,KAAK,CAACE,SAA9B,CAAA;EACO,IAAIC,YAAY,GAAGC,MAAM,CAACC,MAAP,CAAcJ,iBAAd,CAAnB;;EAEP,IAAIK,OAAO,GAAG;EACV,MADU,EAEV,OAFU,EAGV,SAHU,EAIV,KAJU,EAKV,SALU,EAMV,MANU,EAOV,QAPU,CAAd,CAAA;EASAA,OAAO,CAACC,OAAR,CAAgB,UAAAC,MAAM,EAAI;EACtBL,EAAAA,YAAY,CAACK,MAAD,CAAZ,GAAuB,YAAkB;EAAA,IAAA,IAAA,qBAAA,CAAA;;EAAA,IAAA,KAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAALC,GAAK,GAAA,IAAA,KAAA,CAAA,IAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;EAALA,MAAAA,GAAK,CAAA,IAAA,CAAA,GAAA,SAAA,CAAA,IAAA,CAAA,CAAA;EAAA,KAAA;;EACrC;EACA;EACA,IAAAR,CAAAA,qBAAAA,GAAAA,iBAAiB,CAACO,MAAD,CAAjB,EAA0BE,IAA1B,CAAA,KAAA,CAAA,qBAAA,EAAA,CAA+B,IAA/B,CAAA,CAAA,MAAA,CAAwCD,GAAxC,CAAA,CAAA,CAAA;;EACA,IAAIE,IAAAA,QAAQ,GAAG,IAAf,CAAA;EACA,IAAIC,IAAAA,EAAE,GAAG,IAAA,CAAKC,MAAd,CAAA;;EACA,IAAA,QAAQL,MAAR;EACI,MAAA,KAAK,QAAL;EACIG,QAAAA,QAAQ,GAAGF,GAAG,CAACK,KAAJ,CAAU,CAAV,CAAX,CAAA;EACA,QAAA,MAAA;;EACJ,MAAA,KAAK,MAAL,CAAA;EACA,MAAA,KAAK,SAAL;EACIH,QAAAA,QAAQ,GAAGF,GAAX,CAAA;EACA,QAAA,MAAA;EAPR,KAAA;;EASA,IAAA,IAAIE,QAAJ,EAAcC,EAAE,CAACG,YAAH,CAAgBJ,QAAhB,CAAA,CAAA;EAEjB,GAjBD,CAAA;EAkBH,CAnBD,CAAA;;MCVMK;EACF,EAAA,SAAA,OAAA,CAAYC,KAAZ,EAAmB;EAAA,IAAA,eAAA,CAAA,IAAA,EAAA,OAAA,CAAA,CAAA;;EACf;EACA;EACAb,IAAAA,MAAM,CAACc,cAAP,CAAsBD,KAAtB,EAA6B,QAA7B,EAAuC;EACnCA,MAAAA,KAAK,EAAE,IAD4B;EAEnCE,MAAAA,UAAU,EAAE,KAFuB;;EAAA,KAAvC,CAAA,CAAA;;EAIA,IAAA,IAAIpB,OAAO,CAACkB,KAAD,CAAX,EAAoB;EAChBA,MAAAA,KAAK,CAACG,SAAN,GAAkBjB,YAAlB,CAAA;EACA,MAAKY,IAAAA,CAAAA,YAAL,CAAkBE,KAAlB,CAAA,CAAA;EACH,KAHD,MAGO;EACH,MAAKI,IAAAA,CAAAA,IAAL,CAAUJ,KAAV,CAAA,CAAA;EACH,KAAA;EACJ,GAAA;;;;EACD,IAAA,KAAA,EAAA,SAAA,IAAA,CAAKK,MAAL,EAAa;EACTlB,MAAAA,MAAM,CAACmB,IAAP,CAAYD,MAAZ,EAAoBf,OAApB,CAA4B,UAAAiB,GAAG,EAAI;EAC/BC,QAAAA,cAAc,CAACH,MAAD,EAASE,GAAT,EAAcF,MAAM,CAACE,GAAD,CAApB,CAAd,CAAA;EACH,OAFD,CAAA,CAAA;EAGH,KAAA;;;EACD,IAAA,KAAA,EAAA,SAAA,YAAA,CAAaE,IAAb,EAAmB;EAAE;EACjBA,MAAAA,IAAI,CAACnB,OAAL,CAAa,UAAAoB,IAAI,EAAA;EAAA,QAAIC,OAAAA,OAAO,CAACD,IAAD,CAAX,CAAA;EAAA,OAAjB,CAAA,CAAA;EACH,KAAA;;;;;;EAGL,SAASF,cAAT,CAAwBH,MAAxB,EAAgCE,GAAhC,EAAqCP,KAArC,EAA4C;EACxCb,EAAAA,MAAM,CAACc,cAAP,CAAsBI,MAAtB,EAA8BE,GAA9B,EAAmC;EAC/BK,IAAAA,GAD+B,EACzB,SAAA,GAAA,GAAA;EACF,MAAA,OAAOZ,KAAP,CAAA;EACH,KAH8B;EAI/Ba,IAAAA,GAJ+B,EAI3BC,SAAAA,GAAAA,CAAAA,QAJ2B,EAIjB;EACV,MAAIA,IAAAA,QAAQ,IAAId,KAAhB,EAAuB,OAAA;EACvBW,MAAAA,OAAO,CAACG,QAAD,CAAP,CAFU;;EAGVd,MAAAA,KAAK,GAAGc,QAAR,CAAA;EACH,KAAA;EAR8B,GAAnC,CAAA,CAAA;EAUH,CAAA;;EACM,SAASH,OAAT,CAAiBF,IAAjB,EAAuB;EAC1B;EACA,EAAA,IAAI,CAAC7B,QAAQ,CAAC6B,IAAD,CAAb,EAAqB;EACjB,IAAA,OAAA;EACH,GAAA;;EACD,EAAIA,IAAAA,IAAI,CAACb,MAAT,EAAiB;EACb,IAAA,OAAA;EACH,GAPyB;;;EAS1B,EAAA,OAAO,IAAIG,OAAJ,CAAYU,IAAZ,CAAP,CAT0B;EAU7B;;EC/CM,SAASM,SAAT,CAAmBC,EAAnB,EAAuB;EAC1B,EAAA,IAAMC,OAAO,GAAGD,EAAE,CAACE,QAAnB,CAD0B;;EAG1B,EAAA,IAAID,OAAO,CAACE,KAAZ,EAAmB,CAElB;;EACD,EAAA,IAAIF,OAAO,CAAC5B,OAAZ,EAAqB,CAEpB;;EACD,EAAI4B,IAAAA,OAAO,CAACR,IAAZ,EAAkB;EACdW,IAAAA,QAAQ,CAACJ,EAAD,CAAR,CAAA;EACH,GAAA;;EACD,EAAIC,IAAAA,OAAO,CAACI,QAAZ,EAAsB,CAErB;;EACD,EAAIJ,IAAAA,OAAO,CAACK,KAAZ,EAAmB,CAElB;EACJ,CAAA;;EAED,SAASF,QAAT,CAAkBJ,EAAlB,EAAsB;EAClB,EAAIP,IAAAA,IAAI,GAAGO,EAAE,CAACE,QAAH,CAAYT,IAAvB,CADkB;;EAGlBc,EAAAA,OAAO,CAACC,GAAR,CAAYf,IAAZ,CAAA,CAAA;EACAA,EAAAA,IAAI,GAAGO,EAAE,CAACS,KAAH,GAAW,OAAOhB,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,CAAChB,IAAL,CAAUuB,EAAV,CAA7B,GAA6CP,IAA/D,CAAA;EACAE,EAAAA,OAAO,CAACF,IAAD,CAAP,CAAA;EAEH;;EC5Bc,SAASiB,SAAT,CAAmBC,GAAnB,EAAwB;EACnCA,EAAAA,GAAG,CAAC1C,SAAJ,CAAc2C,KAAd,GAAsB,UAAUX,OAAV,EAAmB;EACrCM,IAAAA,OAAO,CAACC,GAAR,CAAYP,OAAZ,CAAA,CAAA;EACA,IAAMD,IAAAA,EAAE,GAAG,IAAX,CAAA;EACAA,IAAAA,EAAE,CAACE,QAAH,GAAcD,OAAd,CAAA;EACAF,IAAAA,SAAS,CAACC,EAAD,CAAT,CAAA;EACH,GALD,CAAA;EAMH;;ECPD,SAASW,GAAT,CAAaV,OAAb,EAAsB;EAClB,EAAKW,IAAAA,CAAAA,KAAL,CAAWX,OAAX,CAAA,CAAA;EACH,CAAA;;EACDS,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}